#
#

language: csharp

os:
  - linux
  - osx

dist: trusty
sudo: required
osx_image: xcode8.3

env:
  global:
    - DOTNET_SKIP_FIRST_TIME_EXPERIENCE=1
    - DOTNET_CLI_TELEMETRY_OPTOUT=1

solution: DjvuNet.Core.sln

mono: none
dotnet: 2.0.0

before_install:
  - if [[ "$TRAVIS_OS_NAME" == "osx" ]]; then brew update; fi
  - if [[ "$TRAVIS_OS_NAME" == "osx" ]]; then brew install mono-libgdiplus; fi
  - if [[ "$TRAVIS_OS_NAME" == "linux" ]]; then sudo apt-get -qq update; fi
  - if [[ "$TRAVIS_OS_NAME" == "linux" ]]; then sudo apt-get install -y zip unzip; fi
  - if [[ "$TRAVIS_OS_NAME" == "linux" ]]; then sudo apt-get install -y libgdiplus; fi

install:


script:
    - chmod u+x build.sh
    - git clone --depth 1 https://github.com/DjvuNet/DjVuLibre.git DjVuLibre
    - curl -L -o artifacts.zip -s https://github.com/DjvuNet/artifacts/releases/download/v0.7.0.11/artifacts.zip
    - unzip -q artifacts.zip -d artifacts
    - dotnet restore DjvuNet.Core.sln
    - cd DjvuNet.NETStandard2.0
    - dotnet build
    - cd ..
    - cd DjvuNet.Core
    - dotnet build
    - cd ..
    - cd DjvuNet.Tests.Core
    - dotnet build -c Debug
    - dotnet xunit -configuration Debug -parallel none -nobuild -notrait Category=SkipNetCoreApp -framework netcoreapp2.0
    - dotnet build -c Release
    - dotnet xunit -configuration Release -parallel none -nobuild -notrait Category=SkipNetCoreApp -framework netcoreapp2.0
    - cd ..
    - cd DjvuNet.Wavelet.Tests.Core
    - dotnet build -c Debug
    - dotnet xunit -configuration Debug -parallel none -nobuild -notrait Category=SkipNetCoreApp -framework netcoreapp2.0
    - dotnet build -c Release
    - dotnet xunit -configuration Release -parallel none -nobuild -notrait Category=SkipNetCoreApp -framework netcoreapp2.0
